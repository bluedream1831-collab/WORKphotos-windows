<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„å°ˆå±¬åŠ ç­è²»è¨ˆç®—å™¨ (V3.0)</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .calculator-container {
            background: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 500px;
        }

        h1 {
            color: #007bff;
            text-align: center;
            margin-bottom: 5px;
        }
        
        h2 {
            color: #0056b3;
            border-bottom: 2px solid #b3e0ff;
            padding-bottom: 5px;
            margin-top: 25px;
        }

        h3 {
            color: #38a700;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 5px;
            margin-top: 20px;
        }

        p.rate-note {
            text-align: center;
            color: #555;
            margin-bottom: 20px;
            font-size: 0.9em;
        }

        .input-group {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            gap: 10px;
        }

        label {
            flex-basis: 60%;
            font-weight: bold;
            color: #444;
        }

        input[type="number"] {
            flex-basis: 25%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 6px;
            text-align: right;
            font-size: 16px;
        }

        span {
            flex-basis: 15%;
            text-align: left;
        }

        .note {
            font-size: 0.8em;
            color: #888;
            flex-basis: 100%;
            margin-top: 5px;
            margin-left: 0;
            text-align: center;
        }

        .variable-highlight {
            background-color: #fff8e1; /* æ·¡é»ƒè‰²èƒŒæ™¯å¼·èª¿æµ®å‹•æ¬„ä½ */
            border: 1px solid #ffe082 !important;
        }

        button {
            width: 100%;
            padding: 12px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 15px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #0056b3;
        }

        .result-area {
            margin-top: 25px;
            padding: 15px;
            background-color: #e9f7ff;
            border: 1px solid #b3e0ff;
            border-radius: 8px;
            text-align: center;
        }

        .result-area p {
            font-size: 2em;
            font-weight: bold;
            color: #d9534f;
            margin: 10px 0 20px 0;
        }

        .result-area h3 + p {
            font-size: 1.5em;
            color: #5cb85c;
            margin: 5px 0;
        }
        
        .monthly-pay-display {
            font-size: 1.1em;
            font-weight: bold;
            color: #0056b3;
            margin-top: 10px;
            border-top: 1px dashed #b3e0ff;
            padding-top: 10px;
        }
    </style>
</head>
<body>
    
    <div class="calculator-container">
        <h1>ğŸ› ï¸ è–ªè³‡èˆ‡åŠ ç­è²»è¨ˆç®—å™¨</h1>
        <p class="rate-note">V3.0 (æ–°å¢æ´¥è²¼èˆ‡çé‡‘æ¬„ä½)</p>

        <h2>ğŸ’° æœˆè–ªçµæ§‹ (å›ºå®š + æµ®å‹•)</h2>
        <div class="input-group">
            <label for="baseSalary">æœ¬ä¿¸</label>
            <input type="number" id="baseSalary" value="37026" min="0">
            <span>å…ƒ</span>
        </div>
        <div class="input-group">
            <label for="mealAllowance">ä¼™é£Ÿæ´¥è²¼</label>
            <input type="number" id="mealAllowance" value="3000" min="0">
            <span>å…ƒ</span>
        </div>
        <div class="input-group">
            <label for="transportAllowance">äº¤é€šæ´¥è²¼</label>
            <input type="number" id="transportAllowance" value="1000" min="0">
            <span>å…ƒ</span>
        </div>
        <div class="input-group">
            <label for="freezerAllowance">å†·å‡æ´¥è²¼</label>
            <input type="number" id="freezerAllowance" value="4000" min="0">
            <span>å…ƒ</span>
        </div>
        <div class="input-group">
            <label for="pickingBonus" style="color: #e67e22;">ç†è²¨çé‡‘ (æµ®å‹•)</label>
            <input type="number" id="pickingBonus" value="2000" min="0" class="variable-highlight">
            <span>å…ƒ</span>
        </div>
        <div class="note">* ç†è²¨çé‡‘ä¸å›ºå®šï¼Œè«‹ä¾ç•¶æœˆå¯¦éš›ç‹€æ³è¼¸å…¥ (2000~3000)</div>
        
        <hr style="margin-top: 20px;">
        <h2>â±ï¸ åŠ ç­æ™‚æ•¸è¼¸å…¥</h2>
        
        <h3>ğŸ’¼ å¹³æ—¥åŠ ç­ (å¹³æ—¥å»¶é•·å·¥æ™‚)</h3>
        <div class="input-group">
            <label for="normalOT1">å‰2å°æ™‚ ($270/æ™‚)</label>
            <input type="number" id="normalOT1" value="0" min="0">
            <span>å°æ™‚</span>
        </div>
        <div class="input-group">
            <label for="normalOT2">ç¬¬3å°æ™‚èµ· ($337/æ™‚)</label>
            <input type="number" id="normalOT2" value="0" min="0">
            <span>å°æ™‚</span>
        </div>
        
        <h3>ğŸ—“ï¸ ä¼‘æ¯æ—¥åŠ ç­</h3>
        <div class="input-group">
            <label for="dayOffOT1">å‰2å°æ™‚ ($270/æ™‚)</label>
            <input type="number" id="dayOffOT1" value="0" min="0">
            <span>å°æ™‚</span>
        </div>
        <div class="input-group">
            <label for="dayOffOT2">ç¬¬3-8å°æ™‚ ($337/æ™‚)</label>
            <input type="number" id="dayOffOT2" value="0" min="0">
            <span>å°æ™‚</span>
        </div>
        <div class="input-group">
            <label for="dayOffOT3">ç¬¬9å°æ™‚èµ· ($540/æ™‚)</label>
            <input type="number" id="dayOffOT3" value="0" min="0">
            <span>å°æ™‚</span>
        </div>
        
        <hr>
        <h3>ğŸ‰ åœ‹å®š/ä¾‹å‡æ—¥/å¤©ç½åŠ ç­</h3>
        <div class="input-group">
            <label for="holidayOT">æ›ä¼‘æ™‚æ•¸ (1:1)</label>
            <input type="number" id="holidayOT" value="0" min="0">
            <span>å°æ™‚</span>
        </div>

        <!-- æŒ‰éˆ• -->
        <button onclick="calculateOT()">é‡æ–°æ•´ç†/è¨ˆç®—</button>

        <div class="result-area">
            <h2>ğŸ’µ æœ¬æœˆé ä¼°ç¸½æ”¶å…¥</h2>
            <p id="totalIncome">0 å…ƒ</p>
            
            <div class="monthly-pay-display">
                <span style="color:#0056b3;">æœˆè–ªçµæ§‹ç¸½é¡ï¼š</span>
                <span id="monthlyBasePay">0 å…ƒ</span>
            </div>

            <h3 style="color:#d9534f;">ğŸ’° åŠ ç­è²»ç¸½é¡</h3>
            <p id="totalPay" style="font-size:1.5em; margin-bottom: 5px;">0 å…ƒ</p>
            
            <h3>â³ åŠ ç­ç¸½æ™‚æ•¸</h3>
            <p id="totalHours" style="font-size:1.5em; color: #5cb85c;">0 å°æ™‚</p>
        </div>
    </div>

    <script>
        // å›ºå®šçš„åŠ ç­è²»ç‡
        const RATES = {
            NORMAL_OT_1: 270, NORMAL_OT_2: 337,
            DAY_OFF_OT_1: 270, DAY_OFF_OT_2: 337, DAY_OFF_OT_3: 540,
            HOLIDAY_OT: 0 // æ›ä¼‘
        };

        // æ‰€æœ‰è¼¸å…¥æ¬„ä½çš„ ID åˆ—è¡¨ (å·²æ›´æ–°ç‚ºæ–°ç‰ˆçµæ§‹)
        const inputIds = [
            'baseSalary', 'mealAllowance', 'transportAllowance', 'freezerAllowance', 'pickingBonus',
            'normalOT1', 'normalOT2',
            'dayOffOT1', 'dayOffOT2', 'dayOffOT3',
            'holidayOT'
        ];

        function calculateOT() {
            // A. å–å¾—æœˆè–ªçµæ§‹è¼¸å…¥å€¼
            const baseSalary = parseFloat(document.getElementById('baseSalary').value) || 0;
            const mealAllowance = parseFloat(document.getElementById('mealAllowance').value) || 0;
            const transportAllowance = parseFloat(document.getElementById('transportAllowance').value) || 0;
            const freezerAllowance = parseFloat(document.getElementById('freezerAllowance').value) || 0;
            const pickingBonus = parseFloat(document.getElementById('pickingBonus').value) || 0;
            
            // è¨ˆç®—æœˆè–ªçµæ§‹ç¸½é¡
            const monthlyBasePay = Math.round(baseSalary + mealAllowance + transportAllowance + freezerAllowance + pickingBonus);

            // B. å–å¾—åŠ ç­æ™‚æ•¸è¼¸å…¥å€¼
            const normalOT1 = parseFloat(document.getElementById('normalOT1').value) || 0;
            const normalOT2 = parseFloat(document.getElementById('normalOT2').value) || 0;
            const dayOffOT1 = parseFloat(document.getElementById('dayOffOT1').value) || 0;
            const dayOffOT2 = parseFloat(document.getElementById('dayOffOT2').value) || 0;
            const dayOffOT3 = parseFloat(document.getElementById('dayOffOT3').value) || 0;
            const holidayOT = parseFloat(document.getElementById('holidayOT').value) || 0; 
            
            // C. è¨ˆç®—ç¸½ç¾é‡‘åŠ ç­è²» (è²»ç‡å›ºå®š)
            const payNormalOT = (normalOT1 * RATES.NORMAL_OT_1) + (normalOT2 * RATES.NORMAL_OT_2);
            const payDayOffOT = (dayOffOT1 * RATES.DAY_OFF_OT_1) + 
                                (dayOffOT2 * RATES.DAY_OFF_OT_2) +
                                (dayOffOT3 * RATES.DAY_OFF_OT_3);
            const payHolidayOT = holidayOT * RATES.HOLIDAY_OT; 

            const totalPay = Math.round(payNormalOT + payDayOffOT + payHolidayOT);
            
            // D. è¨ˆç®—ç¸½æ”¶å…¥ (æœˆè–ª + åŠ ç­è²»)
            const totalIncome = monthlyBasePay + totalPay;

            // E. è¨ˆç®—ç¸½åŠ ç­æ™‚æ•¸
            const totalHours = normalOT1 + normalOT2 + dayOffOT1 + dayOffOT2 + dayOffOT3;
            
            // F. é¡¯ç¤ºçµæœ
            document.getElementById('monthlyBasePay').innerText = `${monthlyBasePay.toLocaleString()} å…ƒ`;
            document.getElementById('totalPay').innerText = `${totalPay.toLocaleString()} å…ƒ`;
            document.getElementById('totalIncome').innerText = `${totalIncome.toLocaleString()} å…ƒ`;
            document.getElementById('totalHours').innerText = `${totalHours.toFixed(1)} å°æ™‚`;

            // å„²å­˜æ•¸æ“š
            saveData();
        }

        // å„²å­˜æ•¸æ“šåˆ° LocalStorage (ä½¿ç”¨æ–°çš„ Key é¿å…èˆ‡èˆŠç‰ˆè¡çª)
        function saveData() {
            const data = {};
            inputIds.forEach(id => {
                data[id] = document.getElementById(id).value;
            });
            localStorage.setItem('mySalaryCalcData_V3', JSON.stringify(data));
        }

        // è¼‰å…¥æ•¸æ“š
        function loadData() {
            const savedData = localStorage.getItem('mySalaryCalcData_V3');
            if (savedData) {
                const data = JSON.parse(savedData);
                inputIds.forEach(id => {
                    if (data[id] !== undefined) {
                        document.getElementById(id).value = data[id];
                    }
                });
            }
        }

        // ç›£è½æ‰€æœ‰è¼¸å…¥æ¡†ï¼Œæ•¸å€¼æ”¹è®Šæ™‚å³æ™‚è¨ˆç®—
        inputIds.forEach(id => {
            document.getElementById(id).addEventListener('input', calculateOT);
        });
        
        // é é¢è¼‰å…¥æ™‚åŸ·è¡Œ
        window.onload = function() {
            loadData();    // å…ˆè¼‰å…¥è³‡æ–™
            calculateOT(); // å†è¨ˆç®—ä¸€æ¬¡
        };
    </script>
</body>
</html>
